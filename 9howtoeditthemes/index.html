<!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-center-atom.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="js,个人博客,前端技术,"><link rel="alternate" href="/atom.xml" title="Yao's Blog" type="application/atom+xml"><meta name="description" content="本文是记录如何修改配置Next，增加百度统计功能、评论区、RSS、爬虫等模块。是在前面几篇文章的扩展记录。 　　注意这些第三方插件，当我们的博客布在github和coding两边时，数据是可以共用的！只要id和key是同样，在服务供应商那边记录域名和网站后，就可以顺利共用数据。"><meta name="keywords" content="js,个人博客,前端技术"><meta property="og:type" content="article"><meta property="og:title" content="搭建个人博客心得---配置主题Next"><meta property="og:url" content="https://YaojiaxinPC.github.io/9howtoeditthemes/index.html"><meta property="og:site_name" content="Yao&#39;s Blog"><meta property="og:description" content="本文是记录如何修改配置Next，增加百度统计功能、评论区、RSS、爬虫等模块。是在前面几篇文章的扩展记录。 　　注意这些第三方插件，当我们的博客布在github和coding两边时，数据是可以共用的！只要id和key是同样，在服务供应商那边记录域名和网站后，就可以顺利共用数据。"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/8.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/9.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/10.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/13.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/14.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/15.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/16.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/1.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/3.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/2.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/4.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/6.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/5.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/7.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/31.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/30.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/17.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/18.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/19.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/20.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/22.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/23.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/24.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/25.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/26.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/27.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/28.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/46.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/50.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/29.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/32.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/35.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/36.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/37.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/38.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/39.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/40.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/41.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/42.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/43.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/44.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/45.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/47.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/48.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/49.png"><meta property="og:image" content="https://yaojiaxinpc.github.io/contentimg/9/51.png"><meta property="og:updated_time" content="2018-10-21T06:38:13.970Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="搭建个人博客心得---配置主题Next"><meta name="twitter:description" content="本文是记录如何修改配置Next，增加百度统计功能、评论区、RSS、爬虫等模块。是在前面几篇文章的扩展记录。 　　注意这些第三方插件，当我们的博客布在github和coding两边时，数据是可以共用的！只要id和key是同样，在服务供应商那边记录域名和网站后，就可以顺利共用数据。"><meta name="twitter:image" content="https://yaojiaxinpc.github.io/contentimg/9/8.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!0,scrollpercent:!0,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://YaojiaxinPC.github.io/9howtoeditthemes/"><title>搭建个人博客心得---配置主题Next | Yao's Blog</title><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?59fb881ccdff1a2b18e2b7839f452118";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head><body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div> <a href="https://github.com/YaojiaxinPC" class="github-corner" aria-label="View source on GitHub" rel="external nofollow noopener noreferrer" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Yao's Blog</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">Welcome to yao's blog.</p></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-question-circle"></i><br> 分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 关于</a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="menu-item-icon fa fa-fw fa-heartbeat"></i><br> 公益404</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br> 搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://YaojiaxinPC.github.io/9howtoeditthemes/"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="姚佳鑫"><meta itemprop="description" content=""><meta itemprop="image" content="/contentimg/headpic.jpg"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Yao's Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">搭建个人博客心得---配置主题Next</h1><div class="post-meta"><i class="fa fa-thumb-tack"></i> <font color="#222">置顶</font> <span class="post-meta-divider">|</span><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-18T23:55:58+08:00">2018-10-18</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程人生/" itemprop="url" rel="index"><span itemprop="name">编程人生</span></a></span></span> <span class="post-comments-count"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-comment-o"></i></span><a href="/9howtoeditthemes/#comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/9howtoeditthemes/" itemprop="commentCount"></span></a></span> <span id="/9howtoeditthemes/" class="leancloud_visitors" data-flag-title="搭建个人博客心得---配置主题Next"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数&#58;</span><span class="leancloud-visitors-count"></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">3k 字</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">11 分钟</span></div></div></header><div class="post-body" itemprop="articleBody"><p>　　本文是记录如何修改配置Next，增加百度统计功能、评论区、RSS、爬虫等模块。是在前面几篇文章的扩展记录。</p><p>　　注意这些第三方插件，当我们的博客布在github和coding两边时，数据是可以共用的！只要id和key是同样，在服务供应商那边记录域名和网站后，就可以顺利共用数据。</p><a id="more"></a><p>　　<br><a href="http://theme-next.iissnan.com/getting-started.html#avatar-setting" rel="external nofollow noopener noreferrer" target="_blank"><strong><em>Next的使用说明</em></strong></a></p><p>　　开头先贴官方配置说明。这里的头像位置、昵称等等，请通过这个官方配置说明链接来配置。本文只分享官方文档里面难的部分，以及文档里面没有的部分。记住配置文件“：”后面需要打空格，然后才加内容！</p><p>　　注意，打开这些第三方服务，会拖慢网站打开速度，请酌情使用。</p><p>　　<a href="http://theme-next.iissnan.com/third-party-services.html#algolia-search" rel="external nofollow noopener noreferrer" target="_blank">官方指导链接</a></p><h2 id="评论系统-amp-文章阅读量统计功能"><a href="#评论系统-amp-文章阅读量统计功能" class="headerlink" title="评论系统&amp;文章阅读量统计功能"></a>评论系统&amp;文章阅读量统计功能</h2><p>　　因为文章访问数量那个系统我用的<a href="https://leancloud.cn/" rel="external nofollow noopener noreferrer" target="_blank">leancloud</a> ，发现配置文件里面刚好也支持它，我就也用的这个服务。</p><p>　　官方文档里面有提到这个阅读理解统计的：</p><p><a href="https://notes.doublemine.me/2015-10-21-为NexT主题添加文章阅读量统计功能.html#%E9%85%8D%E7%BD%AELeanCloud" rel="external nofollow noopener noreferrer" target="_blank">为NexT主题添加文章阅读量统计功能</a></p><p>　　一起凑合着看吧。由于它支持我们改数据，所以我就使用它了。（没事可以偷偷上去改个阅读量999999！）</p><p><img src="/contentimg/9/8.png" alt="Result pic 1" title="创建应用"></p><p><img src="/contentimg/9/9.png" alt="Result pic 1" title="官方教程"></p><p><img src="/contentimg/9/10.png" alt="Result pic 1" title="Counter以及Comment"></p><p>　　注意，第一次创建应用，在这里添加class，需要等2分钟，所以要耐心等。另外，免费版的，不能删除class，所以别加太多了。注意这里：评论的是Comment，文章阅读量的是Counter。</p><p>　　然后就是去获取key和id。这里不能直接鼠标拉选，不过可以右键，定位到元素，然后在代码里面找到这个字符串，就能复制了。</p><p><img src="/contentimg/9/13.png" alt="Result pic 1" title="获取key和id"></p><p><img src="/contentimg/9/14.png" alt="Result pic 1" title="修改配置文件valine"></p><p><img src="/contentimg/9/15.png" alt="Result pic 1" title="修改配置文件leancloud_visitors"></p><p>　　最后，千万记得要去“安全中心”设置“web安全域名”！因为这个id和key是明文，谁都能抓取到的！</p><p><img src="/contentimg/9/16.png" alt="Result pic 1" title="接口屏蔽非安全域名的调用，这会造成网页加载超级慢"></p><p>　　还可以设置邮件提醒<a href="https://github.com/xCss/Valine/wiki/Valine-评论系统中的邮件提醒设置" rel="external nofollow noopener noreferrer" target="_blank">Valine 评论系统中的邮件提醒设置</a></p><h2 id="百度统计"><a href="#百度统计" class="headerlink" title="百度统计"></a><a href="http://tongji.baidu.com/" rel="external nofollow noopener noreferrer" target="_blank">百度统计</a></h2><p>　　文档里面说得很简略，下面我就介绍一下详细的过程。</p><p><img src="/contentimg/9/1.png" alt="Result pic 1" title="百度统计"></p><p>　　怎么打开？</p><p><img src="/contentimg/9/3.png" alt="Result pic 1" title="指导文档说明情况"></p><p><img src="/contentimg/9/2.png" alt="Result pic 1" title="在这里"></p><p><img src="/contentimg/9/4.png" alt="Result pic 1" title="在配置文件这里"></p><p>　　先在百度统计那边复制key，然后到配置文件里面ctrl f找到baidu_analytics 字段，打一个空格后把key复制进去。hexo clean，再生成，让html重新编译，会自动加代码进去的。</p><p><img src="/contentimg/9/6.png" alt="Result pic 1" title="F12查看代码"></p><p>　　如果不会，可以直接发布。然后到百度统计那边检查。</p><p><img src="/contentimg/9/5.png" alt="Result pic 1" title="百度统计自检查"></p><h2 id="内容分享服务"><a href="#内容分享服务" class="headerlink" title="内容分享服务"></a>内容分享服务</h2><p><img src="/contentimg/9/7.png" alt="Result pic 1" title="不支持https"></p><p>　　第一个JiaThis，搜索有新闻说已经关闭分享服务了。第三个好像是国外，搞推特的，国内访问应该比较慢，也不考虑。后面找了Mob，但是不支持https，所以也用不了。</p><p>　　剩下一个百度，结果，打开后发现很丑，还只能分享图片，不能整篇文章分享（得改代码）。所以我就没开该项。请自取哈。</p><p><img src="/contentimg/9/31.png" alt="Result pic 1" title="取消注释该两项即可"></p><p><img src="/contentimg/9/30.png" alt="Result pic 1" title="百度分析效果"></p><p>　　分享的效果也不好，点击后调整的界面不好看。</p><h2 id="字数统计-amp-阅读时长"><a href="#字数统计-amp-阅读时长" class="headerlink" title="字数统计&amp;阅读时长"></a><a href="https://www.cnblogs.com/php-linux/p/8418518.html" rel="external nofollow noopener noreferrer" target="_blank">字数统计&amp;阅读时长</a></h2><p><img src="/contentimg/9/17.png" alt="Result pic 1" title="配置文件post_wordcount"></p><p>　　里面已经内置了，开启就能使用了。但是单纯改配置文件，数字是显示不出来的，得添加插件：</p><blockquote><p> npm install hexo-wordcount –save -dev</p></blockquote><p>　　安装完成后，hexo clean；hexo g。启动服务就能看到效果了。如果想像我这边一样加文字：</p><p>　　到目录：/themes/next/layout/_macro/post.swig</p><p>　　用记事本打开后搜索post_wordcount：</p><p><img src="/contentimg/9/18.png" alt="Result pic 1" title="添加字和分钟"><br>　　<br><img src="/contentimg/9/19.png" alt="Result pic 1" title="效果"></p><h2 id="RSS"><a href="#RSS" class="headerlink" title="RSS"></a><a href="https://www.jianshu.com/p/a79422ab2013" rel="external nofollow noopener noreferrer" target="_blank">RSS</a></h2><blockquote><p> npm install hexo-generator-feed –save -dev</p></blockquote><p>　　然后到主配置文件最底下添加：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Extensions</span><br><span class="line"><span class="function">plugins:</span></span><br><span class="line"><span class="function">    <span class="title">hexo</span>-<span class="title">generator</span>-<span class="title">feed</span></span></span><br><span class="line"><span class="function">#<span class="title">Feed</span> <span class="title">Atom</span></span></span><br><span class="line"><span class="function"><span class="title">feed</span>:</span></span><br><span class="line"><span class="function">    <span class="title">type</span>: <span class="title">atom</span></span></span><br><span class="line"><span class="function">    <span class="title">path</span>: <span class="title">atom.xml</span></span></span><br><span class="line"><span class="function">    <span class="title">limit</span>: 20</span></span><br></pre></td></tr></table></figure><p><img src="/contentimg/9/20.png" alt="Result pic 1" title="添加RSS生成配置"></p><p>　　这个插件的作用是统计记录你的文章，生成一个xml格式的文件atom.xml。别人通过订阅分析你这个文件变动来了解你文章的更新情况。</p><p><img src="/contentimg/9/22.png" alt="Result pic 1" title="简书上博主分享的操作"></p><h2 id="百度sitemap"><a href="#百度sitemap" class="headerlink" title="百度sitemap"></a><a href="https://blog.csdn.net/heqiangflytosky/article/details/54863166" rel="external nofollow noopener noreferrer" target="_blank">百度sitemap</a></h2><blockquote><p> npm install hexo-generator-baidu-sitemap –save -dev</p></blockquote><p><img src="/contentimg/9/23.png" alt="Result pic 1" title="百度sitemap情况"></p><p>　　在百度里面搜索site:域名。检验是否被百度收录。如果没有的，需要进行登记。这里google的操作比较简单。</p><p>　　百度的，由于被github屏蔽爬虫，所以只能考虑放coding上面。coding的免费玩家，是会强制301转址的，所以这时候放百度验证，是无法成功的，百度验证不会像浏览器那样跳转识别，在说明那里也提到：“如果存在转址，请暂时取消”。</p><p><img src="/contentimg/9/24.png" alt="Result pic 1" title="coding要求"></p><p>　　那怎么玩？只能想办法完成这个coding要求了。加图标的话，布局上没想到怎么改。所以我选择加文字版：</p><p><img src="/contentimg/9/25.png" alt="Result pic 1" title="coding要求文字版"></p><p><img src="/contentimg/9/26.png" alt="Result pic 1" title="coding要求文字版效果"></p><p>　　刚开始还去翻代码，结果发现原来NexT考虑到这个问题了，直接给我们加在配置文件里面，只需要去设置这个属性就行，不用改代码。</p><p><img src="/contentimg/9/27.png" alt="Result pic 1" title="修改配置文件位置"></p><p>　　这里会遇到一个问题，当你把coding那边那个代码复制过来时，hexo g会报错！原来是由于没换行的概念，hexo读配置属性，是根据“：+空格”来判断的，所以只需要把那个空格删掉，它就不识别成属性，就不会报错。</p><p>　　接下来就是等通过验证然后来搞百度收录了。</p><p><a href="http://zhanzhang.baidu.com/linksubmit/url" rel="external nofollow noopener noreferrer" target="_blank">百度收录链接</a></p><p>　　收录前需要进行的<a href="http://zhanzhang.baidu.com/site/siteadd" rel="external nofollow noopener noreferrer" target="_blank">验证网站所有权</a> 。就是上面提到的验证。</p><p>　　这里有三种方式可以做到：挂文件/在html加代码/CNAME。推荐第一种，因为第二种就直接明文了。当然，最后我还是用了第三种，CNAME，只需要去dns服务商那边设置就行了，马上就生效了，不用等coding过检。</p><h3 id="挂文件"><a href="#挂文件" class="headerlink" title="挂文件"></a>挂文件</h3><p>　　就是把密码文件下载下来后，放在source根目录，然后到主配置文件找skip_render属性：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">skip_render: </span><br><span class="line"> - baidu_verify_XXXXXX.html</span><br></pre></td></tr></table></figure><p>　　防止hexo添加代码到该密码文件，百度爬虫才能识别到该文件。</p><h3 id="加代码"><a href="#加代码" class="headerlink" title="加代码"></a>加代码</h3><p>　　找到文件\themes\next\layout_partials\head.swig。然后直接在这里的空白处插入代码。</p><p><img src="/contentimg/9/28.png" alt="Result pic 1" title="在head插入代码"></p><p>　　百度统计那边功能蛮多的，不过现在博客暂时还没收录，等收录后体验下其他的功能。</p><p>　　在配置好后，到配置文件启用：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">baidusitemap:</span></span><br><span class="line"><span class="function">  <span class="title">path</span>: <span class="title">baidusitemap.xml</span></span></span><br></pre></td></tr></table></figure><p>　　再到百度提交收录：</p><p><img src="/contentimg/9/46.png" alt="Result pic 1" title="提交百度收录"></p><p>　　建议开启百度自动推送，就sitemap左边那个。代码已经集成在Next了，只要开启主题配置文件的属性“baidu_push”：</p><p><img src="/contentimg/9/50.png" alt="Result pic 1" title="百度自动推送"></p><h2 id="Google收录"><a href="#Google收录" class="headerlink" title="Google收录"></a>Google收录</h2><blockquote><p> npm install hexo-generator-sitemap –save -dev</p></blockquote><p>　　开vpn，<a href="https://www.google.com/webmasters/tools/home?hl=zh-CN" rel="external nofollow noopener noreferrer" target="_blank">Google站长工具</a> 类似百度收录的操作，都是下载密码html文件，放在根目录，然后到主配置文件添加忽略编译属性。</p><p>　　好处是github没有屏蔽google，所以直接用github那边的挂谷歌。而且他们都是国外的，所以挂github的话，比挂国内的coding对搜索排名要有利。</p><p><img src="/contentimg/9/29.png" alt="Result pic 1" title="马上过检"></p><p>　　在配置好后，到配置文件启用：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#sitemap</span><br><span class="line"><span class="function">sitemap:</span></span><br><span class="line"><span class="function">  <span class="title">path</span>: <span class="title">sitemap.xml</span></span></span><br></pre></td></tr></table></figure><p>　　同样要去提交收录。但是超级快，一下就能在谷歌搜索到了。</p><h2 id="其他第三方服务"><a href="#其他第三方服务" class="headerlink" title="其他第三方服务"></a>其他第三方服务</h2><p><img src="/contentimg/9/32.png" alt="Result pic 1" title="目标目录"></p><p>　　到该目录下，列了目前NexT集成的第三方服务，可以根据文件名来选择要不要开启，都是在配置文件里面能找到开启选项的。其实这里的作用，就是把全部js脚本放在这里，然后用一个配置文件属性，判断要不要加这个脚本到html里面。</p><h2 id="其他优化"><a href="#其他优化" class="headerlink" title="其他优化"></a>其他优化</h2><p>　　第三方的东西我目前只加了这些，其他就是代码上的修改了。</p><h3 id="文章末尾添加“—end—”"><a href="#文章末尾添加“—end—”" class="headerlink" title="文章末尾添加“—end—”"></a>文章末尾添加“—end—”</h3><p>　　打开themes\next\layout_macro\post.swig，找到“wechat_subscriber”的地方，这个就是文章结尾时，“请加我好友”的图标所在的地方。复制如下代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">   &#123;% if not is_index %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"text-align:center;color: #ccc;font-size:20px;"</span>&gt;</span>-------------------------------------------------------- The End --------------------------------------------------------<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p>　　这里文字大小和长度，请根据自己喜好进行修改。</p><p>　　或者是使用hr写法。注意这里<a href="https://blog.csdn.net/lunhui1994_/article/details/79085805" rel="external nofollow noopener noreferrer" target="_blank">文本文字在DIV中垂直水平居中显示</a></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">   &#123;% if not is_index %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"height:85px;line-height:85px;text-align:center;color:#ccc;font-size:20px"</span>&gt;</span><span class="tag">&lt;<span class="name">hr</span> <span class="attr">size</span>=<span class="string">"7"</span> <span class="attr">color</span>=<span class="string">"coral"</span> <span class="attr">style</span>=<span class="string">"vertical-align:middle;float:left"</span> <span class="attr">width</span>=<span class="string">"40%"</span>&gt;</span> The End <span class="tag">&lt;<span class="name">hr</span> <span class="attr">size</span>=<span class="string">"7"</span> <span class="attr">color</span>=<span class="string">"coral"</span> <span class="attr">style</span>=<span class="string">"vertical-align:middle;float:right"</span> <span class="attr">width</span>=<span class="string">"40%"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> <span class="attr">style</span>=<span class="string">"clear:both"</span>/&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p>　　但在手机端效果不行，换行了。</p><h3 id="取消打赏的文字摇晃"><a href="#取消打赏的文字摇晃" class="headerlink" title="取消打赏的文字摇晃"></a>取消打赏的文字摇晃</h3><p>　　自带的摇晃太魔性了，建议去掉。到位置：next/source/css/_common/components/post/post-reward.styl ，搜“animation”：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">加“<span class="comment">/*  */</span>”</span><br></pre></td></tr></table></figure><p><img src="/contentimg/9/35.png" alt="Result pic 1" title="屏蔽代码"></p><h3 id="浏览页面的时候显示当前浏览进度"><a href="#浏览页面的时候显示当前浏览进度" class="headerlink" title="浏览页面的时候显示当前浏览进度"></a>浏览页面的时候显示当前浏览进度</h3><p>　　到主题配置文件，搜scrollpercent，改为true。</p><p><img src="/contentimg/9/36.png" alt="Result pic 1" title="显示浏览进度"></p><p>　　还可以放到左边：修改scrollpercent上方的b2t为true。</p><p><img src="/contentimg/9/37.png" alt="Result pic 1" title="浏览进度显示在左边"></p><p><img src="/contentimg/9/38.png" alt="Result pic 1" title="两个修改项"></p><h3 id="fork-me-on-github"><a href="#fork-me-on-github" class="headerlink" title="fork me on github"></a>fork me on github</h3><h4 id="右上角"><a href="#右上角" class="headerlink" title="右上角"></a>右上角</h4><p>　　到<a href="http://tholman.com/github-corners/" rel="external nofollow noopener noreferrer" target="_blank">GitHub Corners</a> 选择喜欢的样式，复制代码。然后定位到next/layout/_layout.swig，搜索headband。将代码贴在下面：</p><p><img src="/contentimg/9/39.png" alt="Result pic 1" title="右边实例"></p><h3 id="左上角"><a href="#左上角" class="headerlink" title="左上角"></a>左上角</h3><p>　　到<a href="https://blog.github.com/2008-12-19-github-ribbons/" rel="external nofollow noopener noreferrer" target="_blank">Fork_me_on_GitHub</a> 选样式，像上面一样操作。当然也可以自己根据实际情况微调。</p><h3 id="将标签前缀“-”换为图标"><a href="#将标签前缀“-”换为图标" class="headerlink" title="将标签前缀“#”换为图标 "></a>将标签前缀“#”换为图标<i class="fa fa-tag"></i></h3><p>　　到next/layout/_macro/post.swig，搜索</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rel=<span class="string">"tag"</span></span><br></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">将 #号 换成&lt;i class="fa fa-tag"&gt;&lt;/i&gt;</span><br></pre></td></tr></table></figure><p><img src="/contentimg/9/40.png" alt="Result pic 1" title="修改#为图标"></p><p><img src="/contentimg/9/41.png" alt="Result pic 1" title="效果"></p><h3 id="添加加载页面"><a href="#添加加载页面" class="headerlink" title="添加加载页面"></a>添加加载页面</h3><p><img src="/contentimg/9/42.png" alt="Result pic 1" title="加载进度条"></p><p>　　在next的配置文件搜“pace-theme”：这里我这个是pace-theme-center-atom，还有其他一堆可以选。</p><p><img src="/contentimg/9/43.png" alt="Result pic 1" title="加载进度条设置"></p><h3 id="添加站内搜索"><a href="#添加站内搜索" class="headerlink" title="添加站内搜索"></a>添加站内搜索</h3><blockquote><p> npm install hexo-generator-searchdb –save</p></blockquote><p>　　这里可能下载不下来，按照我前面说copy怎么下载那样，在npm失败后，会显示一个html，拿到百度云离线下载，下下来后，用记事本打开，搜version，找到最新版本，然后看barl的下载链接，再复制到百度云离线下载，然后当做本地文件来安装，就能安装了。</p><p>　　到主配置文件最后添加：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#表示站内搜索</span></span><br><span class="line">search:  </span><br><span class="line">    path: search.xml</span><br><span class="line">    field: post</span><br><span class="line">    format: html</span><br><span class="line">    <span class="built_in">limit</span>: 10000</span><br></pre></td></tr></table></figure><p>　　然后到NexT配置文件搜索“local_search”，启动enable：</p><p><img src="/contentimg/9/44.png" alt="Result pic 1" title="启动站内搜索"></p><h3 id="修改访问URL路径"><a href="#修改访问URL路径" class="headerlink" title="修改访问URL路径"></a>修改访问URL路径</h3><p>　　默认情况下是年月日一串很长的url路径。是在主配置文件进行的修改：搜索“permalink”</p><blockquote><p> permalink: :category/:title/ #分类/标题</p></blockquote><p><img src="/contentimg/9/45.png" alt="Result pic 1" title="修改访问url路径"></p><h3 id="添加文章置顶功能"><a href="#添加文章置顶功能" class="headerlink" title="添加文章置顶功能"></a><a href="https://blog.csdn.net/qwerty200696/article/details/79010629" rel="external nofollow noopener noreferrer" target="_blank">添加文章置顶功能</a></h3><p>　　现在应该都是新版本了，所以直接介绍新版本的方式：</p><p>先卸载老插件，然后装新插件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall hexo-generator-index --save</span><br><span class="line">npm install hexo-generator-index-pin-top --save -dev</span><br></pre></td></tr></table></figure><p>　　然后在文章开头加 “top: 数字”</p><p><img src="/contentimg/9/47.png" alt="Result pic 1" title="置顶设置"></p><p>　　这样就能看的效果了。不过推荐加一下置顶图标在前面：</p><p>　　打开next/layout/_macro/post.swig，搜索<br></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-meta"</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><p>　　然后加入如下代码：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">if</span> post.top %&#125;</span><br><span class="line">    &lt;i class="fa fa-thumb-tack"&gt;&lt;/i&gt;</span><br><span class="line">    &lt;font <span class="built_in">color</span>=#<span class="number">222</span>&gt;置顶&lt;/font&gt;</span><br><span class="line">    &lt;span class="post-meta-divider"&gt;|&lt;/span&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p><img src="/contentimg/9/48.png" alt="Result pic 1" title="添加置顶图标"></p><p><img src="/contentimg/9/49.png" alt="Result pic 1" title="置顶效果">　　</p><h3 id="添加coding部分的一键复制功能"><a href="#添加coding部分的一键复制功能" class="headerlink" title="添加coding部分的一键复制功能"></a><a href="https://yfzhou.coding.me/2018/08/27/Hexo-Next%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%BB%A3%E7%A0%81%E5%9D%97%E5%A4%8D%E5%88%B6%E5%8A%9F%E8%83%BD%EF%BC%89/" rel="external nofollow noopener noreferrer" target="_blank">添加coding部分的一键复制功能</a></h3><p>　　本博客没启用该功能，具体请访问该链接：<a href="https://yfzhou.coding.me/2018/08/27/Hexo-Next%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%BB%A3%E7%A0%81%E5%9D%97%E5%A4%8D%E5%88%B6%E5%8A%9F%E8%83%BD%EF%BC%89/" rel="external nofollow noopener noreferrer" target="_blank">添加coding部分的一键复制功能</a></p><p>　　由于有中文，该链接通过中文转码处理，如果失效，请通过域名查找。</p><h3 id="添加Robot和nofollow"><a href="#添加Robot和nofollow" class="headerlink" title="添加Robot和nofollow"></a>添加Robot和nofollow</h3><p>　　新建robots.txt文件在source根目录下：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#hexo robots.txt</span><br><span class="line">User-agent: *</span><br><span class="line"></span><br><span class="line"><span class="function">Allow: /</span></span><br><span class="line"><span class="function"><span class="title">Allow</span>: /<span class="title">archives</span>/</span></span><br><span class="line"><span class="function"><span class="title">Allow</span>: /<span class="title">categories</span>/</span></span><br><span class="line"><span class="function"><span class="title">Allow</span>: /<span class="title">tags</span>/</span></span><br><span class="line"><span class="function"><span class="title">Allow</span>: /<span class="title">about</span>/</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Disallow</span>: /404/</span></span><br><span class="line"><span class="function"><span class="title">Disallow</span>: /<span class="title">contentimg</span>/</span></span><br><span class="line"><span class="function"><span class="title">Disallow</span>: /<span class="title">css</span>/</span></span><br><span class="line"><span class="function"><span class="title">Disallow</span>: /<span class="title">images</span>/</span></span><br><span class="line"><span class="function"><span class="title">Disallow</span>: /<span class="title">js</span>/</span></span><br><span class="line"><span class="function"><span class="title">Disallow</span>: /<span class="title">lib</span>/</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Sitemap</span>: <span class="title">http</span>://<span class="title">yaojx.net</span>/<span class="title">search.xml</span></span></span><br><span class="line"><span class="function"><span class="title">Sitemap</span>: <span class="title">http</span>://<span class="title">yaojx.net</span>/<span class="title">sitemap.xml</span></span></span><br><span class="line"><span class="function"><span class="title">Sitemap</span>: <span class="title">http</span>://<span class="title">yaojx.net</span>/<span class="title">baidusitemap.xml</span></span></span><br></pre></td></tr></table></figure><p>　　当没这个文件时，默认全部内容可以爬，这个文件就是告诉那些可以爬，那些不行。</p><blockquote><p> npm install hexo-autonofollow –save</p></blockquote><p>　　当文章中有链接时，爬虫会顺着链接爬出去。所以得加这个nofollow。</p><p>　　安装完后，到主配置文件最底下添加：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">nofollow:</span></span><br><span class="line"><span class="function">    <span class="title">enable</span>: <span class="title">true</span></span></span><br><span class="line"><span class="function">    <span class="title">exclude</span>:</span></span><br><span class="line"><span class="function">        - <span class="title">yaojx.net</span></span></span><br></pre></td></tr></table></figure><p>　　然后就是去百度站长提交robot文件了。</p><h3 id="qq点击后直接开打联系我的窗口"><a href="#qq点击后直接开打联系我的窗口" class="headerlink" title="qq点击后直接开打联系我的窗口"></a>qq点击后直接开打联系我的窗口</h3><p>　　该功能使用的是腾讯的开放接口：</p><p><img src="/contentimg/9/51.png" alt="Result pic 1" title="next配置文件设置">　　</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://wpa.qq.com/msgrd?v=3&amp;uin=659771655&amp;site=qq&amp;menu=yes</span><br></pre></td></tr></table></figure><p>　　uin改成自己的qq就行了。</p><p>这里有几篇文章是讲怎么修改整个主题的，重点推荐：<br><a href="http://yangbingdong.com/2017/build-blog-hexo-advanced/" rel="external nofollow noopener noreferrer" target="_blank">基于Hexo搭建个人博客——进阶篇(从入门到入土)</a><br><a href="https://segmentfault.com/a/1190000016527304" rel="external nofollow noopener noreferrer" target="_blank">Hexo搭建GitHub博客—打造炫酷的NexT主题–高级(四)</a><br><a href="https://www.colabug.com/1840493.html" rel="external nofollow noopener noreferrer" target="_blank">Hexo+Next个人博客主题优化</a></p></div><div style="height:85px;line-height:85px;text-align:center;color:#ccc;font-size:20px"><hr size="7" color="coral" style="vertical-align:middle;float:left" width="40%"> The End<hr size="7" color="coral" style="vertical-align:middle;float:right" width="40%"><br style="clear:both"></div><div><div id="wechat_subscriber" style="display:block;padding:10px 0;margin:20px auto;width:100%;text-align:center"> <img id="wechat_subscriber_qcode" src="/images/wechataddfriend.png" alt="姚佳鑫 wechat" style="width:200px;max-width:100%"><div>如果您对我的文章感兴趣，可以添加我的微信</div></div></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>感谢您的支持</div> <button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'> <span>打赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"> <img id="wechat_qr" src="/images/wechatpay.png" alt="姚佳鑫 微信支付"><p>微信支付</p></div><div id="alipay" style="display:inline-block"> <img id="alipay_qr" src="/images/alipay.png" alt="姚佳鑫 支付宝"><p>支付宝</p></div></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 姚佳鑫</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://YaojiaxinPC.github.io/9howtoeditthemes/" title="搭建个人博客心得---配置主题Next">https://YaojiaxinPC.github.io/9howtoeditthemes/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow noopener noreferrer" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/js/" rel="tag"><i class="fa fa-tag"></i> js</a><a href="/tags/个人博客/" rel="tag"><i class="fa fa-tag"></i> 个人博客</a><a href="/tags/前端技术/" rel="tag"><i class="fa fa-tag"></i> 前端技术</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/8SupGitPage/" rel="next" title="搭建个人博客心得---个人站点yaojx.net的优化之路"><i class="fa fa-chevron-left"></i> 搭建个人博客心得---个人站点yaojx.net的优化之路</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/10ffmpeg-aes-1/" rel="prev" title="ffmpeg-简单AES加解密记录">ffmpeg-简单AES加解密记录<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div><div class="comments" id="comments"></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/contentimg/headpic.jpg" alt="姚佳鑫"><p class="site-author-name" itemprop="name">姚佳鑫</p><p class="site-description motion-element" itemprop="description">Record My Coding life.</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">29</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/index.html"><span class="site-state-item-count">19</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">49</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/YaojiaxinPC" target="_blank" title="GitHub" rel="external nofollow noopener noreferrer"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://wpa.qq.com/msgrd?v=3&uin=659771655&site=qq&menu=yes" target="_blank" title="QQ" rel="external nofollow noopener noreferrer"><i class="fa fa-fw fa-qq"></i> QQ</a></span></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#评论系统-amp-文章阅读量统计功能"><span class="nav-number">1.</span> <span class="nav-text">评论系统&amp;文章阅读量统计功能</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#百度统计"><span class="nav-number">2.</span> <span class="nav-text">百度统计</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#内容分享服务"><span class="nav-number">3.</span> <span class="nav-text">内容分享服务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#字数统计-amp-阅读时长"><span class="nav-number">4.</span> <span class="nav-text">字数统计&amp;阅读时长</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSS"><span class="nav-number">5.</span> <span class="nav-text">RSS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#百度sitemap"><span class="nav-number">6.</span> <span class="nav-text">百度sitemap</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#挂文件"><span class="nav-number">6.1.</span> <span class="nav-text">挂文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#加代码"><span class="nav-number">6.2.</span> <span class="nav-text">加代码</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Google收录"><span class="nav-number">7.</span> <span class="nav-text">Google收录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#其他第三方服务"><span class="nav-number">8.</span> <span class="nav-text">其他第三方服务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#其他优化"><span class="nav-number">9.</span> <span class="nav-text">其他优化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#文章末尾添加“—end—”"><span class="nav-number">9.1.</span> <span class="nav-text">文章末尾添加“—end—”</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#取消打赏的文字摇晃"><span class="nav-number">9.2.</span> <span class="nav-text">取消打赏的文字摇晃</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#浏览页面的时候显示当前浏览进度"><span class="nav-number">9.3.</span> <span class="nav-text">浏览页面的时候显示当前浏览进度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fork-me-on-github"><span class="nav-number">9.4.</span> <span class="nav-text">fork me on github</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#右上角"><span class="nav-number">9.4.1.</span> <span class="nav-text">右上角</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#左上角"><span class="nav-number">9.5.</span> <span class="nav-text">左上角</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#将标签前缀“-”换为图标"><span class="nav-number">9.6.</span> <span class="nav-text">将标签前缀“#”换为图标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#添加加载页面"><span class="nav-number">9.7.</span> <span class="nav-text">添加加载页面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#添加站内搜索"><span class="nav-number">9.8.</span> <span class="nav-text">添加站内搜索</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#修改访问URL路径"><span class="nav-number">9.9.</span> <span class="nav-text">修改访问URL路径</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#添加文章置顶功能"><span class="nav-number">9.10.</span> <span class="nav-text">添加文章置顶功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#添加coding部分的一键复制功能"><span class="nav-number">9.11.</span> <span class="nav-text">添加coding部分的一键复制功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#添加Robot和nofollow"><span class="nav-number">9.12.</span> <span class="nav-text">添加Robot和nofollow</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#qq点击后直接开打联系我的窗口"><span class="nav-number">9.13.</span> <span class="nav-text">qq点击后直接开打联系我的窗口</span></a></li></ol></li></ol></div></div></section><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2018</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">姚佳鑫</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i></span> <span class="post-meta-item-text">Site words total count&#58;</span> <span title="Site words total count">40.4k</span></div><div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io" rel="external nofollow noopener noreferrer">Hexo</a> 强力驱动</div> <span class="post-meta-divider">|</span><div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next" rel="external nofollow noopener noreferrer">NexT.Gemini</a> v5.1.4</div></div></footer></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: true,
        notify: true,
        appId: 'MKSSliaXY1yJfNdREDKmugjN-gzGzoHsz',
        appKey: 'JXNiobIr2wdnlcGKbKeKAUlP',
        placeholder: 'ʕ̢̣̣̣̣̩̩̩̩·͡˔·ོɁ̡̣̣̣̣̩̩̩̩',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script><script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script><script>AV.initialize("MKSSliaXY1yJfNdREDKmugjN-gzGzoHsz","JXNiobIr2wdnlcGKbKeKAUlP")</script><script>function showTime(e){var t=new AV.Query(e),c=[],u=$(".leancloud_visitors");u.each(function(){c.push($(this).attr("id").trim())}),t.containedIn("url",c),t.find().done(function(e){var t=".leancloud-visitors-count";if(0!==e.length){for(var n=0;n<e.length;n++){var o=e[n],i=o.get("url"),s=o.get("time"),r=document.getElementById(i);$(r).find(t).text(s)}for(n=0;n<c.length;n++){i=c[n],r=document.getElementById(i);var l=$(r).find(t);""==l.text()&&l.text(0)}}else u.find(t).text(0)}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(i){var e=$(".leancloud_visitors"),s=e.attr("id").trim(),r=e.attr("data-flag-title").trim(),t=new AV.Query(i);t.equalTo("url",s),t.find({success:function(e){if(0<e.length){var t=e[0];t.fetchWhenSave(!0),t.increment("time"),t.save(null,{success:function(e){$(document.getElementById(s)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var n=new i,o=new AV.ACL;o.setPublicReadAccess(!0),o.setPublicWriteAccess(!0),n.setACL(o),n.set("title",r),n.set("url",s),n.set("time",1),n.save(null,{success:function(e){$(document.getElementById(s)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):1<$(".post-title-link").length&&showTime(e)})</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script></body></html>